---
title: "KEHTO"
author: "Kaisa Lahtinen"
date: "6 helmikuuta 2018"
output:
  html_document: default
  pdf_document: default
  word_document: default
---

R Markdown dokumentti joka ker?? yhteen alustavat analyysit Kunta10 kehitt?mistoimenpiteitten kirjaamisen tutkimisesta. Alussa k?yd??n l?pi taustamuuttujien jakauma kirjanneiden ja ei-kirjanneiden ty?ykisk?iden v?lill?. T?m? on tehty siit? huolimatta ett? emm? pysty m??ritt?m??n olisiko ty?ykisk?n pit?nyt kehitt?mistoimenpiteit? kirjata vai ei. Mutta emme pysty analysoimaan mik? m??ritt?? ty?yksik?n, tai mitk? ovat sen tyyppi piirteit? jollei meill? ole verrokkiryhm?? (mun ajatusmoka viime kokouksessa, sori)

Sitten seuraavaksi katsomme miten nelj? eniten valittun kehitt?mistoimenpiteen alkuper?iset arvot jakautuvat kirjanneiden ja ei-kirjanneiden v?lill?.

kolmanneksi katsomme oliko 'liikennevaloilla' oikeasti merkityst? kehitt?mistoimenpiteit? valittaessa. Ja viimeksi LASSO (Least Absolute Shrinkage Selector Operator), regression arvioimaan ett? mitk? muuttujan parhaiten ennustavat kehitt?mistoimenpiteen valintaa. (Lasso regression analysis is a shrinkage and variable selection method for linear regression models. The goal of lasso regression is to obtain the subset of predictors that minimizes prediction error for a quantitative response variable. The lasso does this by imposing a constraint on the model parameters that causes regression coefficients for some variables to shrink toward zero. Variables with a regression coefficient equal to zero after the shrinkage process are excluded from the model. Variables with non-zero regression coefficients variables are most strongly associated with the response variable)

Does this work?

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(dplyr)
data <- read_excel("kehto_data2501.xls")
head(data)
tail(data)

## Liit? dataan muu tieto
sofokus_kunta10_Adata <- read_excel("P:/Projektit/FPSS/palauteportaali/kunta10/2016/sofokus_kunta10_Adata.xlsx",
sheet = "A data 2016")

kunta10_muuttujakuvaus <- read_excel("P:/Projektit/FPSS/palauteportaali/kunta10/2016/sofokus_kunta10_Adata.xlsx",
sheet = "Muuttujakuvaus")


# merge two data f
k_dat <- merge(data, sofokus_kunta10_Adata, by=c("tyopaikka"), all.x = TRUE)

# merge two data f
s_dat <- merge(sofokus_kunta10_Adata, data, by=c("tyopaikka"), all.x = TRUE)
s_dat$kehto <- 1
s_dat$kehto[is.na(s_dat$kyselyvuosi)] <- 0

## poista tarpeettomat muuttujat
k_dat <- k_dat[, -c(98:294)]

# kunnon muuttuja nimet vahvuuksille
k_dat$vahvuus_m <-kunta10_muuttujakuvaus$Muuttuja[match(k_dat$vahvuusmittari, kunta10_muuttujakuvaus$Selite)]
k_dat$k1_m <-kunta10_muuttujakuvaus$Muuttuja[match(k_dat$kehkohdemittari1, kunta10_muuttujakuvaus$Selite)]
k_dat$k2_m <-kunta10_muuttujakuvaus$Muuttuja[match(k_dat$kehkohdemittari2, kunta10_muuttujakuvaus$Selite)]
k_dat$k3_m <-kunta10_muuttujakuvaus$Muuttuja[match(k_dat$kehkohdemittari3, kunta10_muuttujakuvaus$Selite)]

head(kunta10_muuttujakuvaus$Selite)

sum(is.na(k_dat$k1_m))
sum(is.na(k_dat$kehkohdemittari1))

## Poista yhden vastaajan kustannuspaikat
k_dat2 <-  k_dat[ which(k_dat$saajia >9), ]

k_dat2$kunta <-substr(k_dat2$tyopaikka, start = 1, stop = 2)
k_dat2$m1_p <- 0
k_dat2$m1_p[k_dat2$m1 < 2.004] <- 1
k_dat2$m1_v <- 0
k_dat2$m1_v[k_dat2$m1 > 3.539] <- 1
k_dat2$m2_p <- 0
k_dat2$m2_p[k_dat2$m2 > 3.830] <- 1
k_dat2$m3_p<- 0
k_dat2$m3_p[k_dat2$m3 < 3.267] <- 1
k_dat2$m3_v <- 0
k_dat2$m3_v[k_dat2$m3 > 4.072] <- 1
k_dat2$m4_p <- 0
k_dat2$m4_p[k_dat2$m4 > 47.368] <- 1
k_dat2$m66_p <- 0
k_dat2$m66_p[k_dat2$m66 > 58.824] <- 1
k_dat2$m8_p <- 0
k_dat2$m8_p[k_dat2$m8 > 2.625] <- 1
k_dat2$m48_v<- 0
k_dat2$m48_v[k_dat2$m48 > 0.714] <- 1
k_dat2$m48_p <- 0
k_dat2$m48_p[k_dat2$m48 < -0.682] <- 1
k_dat2$m54_p <- 0
k_dat2$m54_p[k_dat2$m54 > 63.636] <- 1
k_dat2$m9_p <- 0
k_dat2$m9_p[k_dat2$m9 > 40.909] <- 1
k_dat2$m10_p <- 0
k_dat2$m10_p[k_dat2$m10 > 48.485] <- 1
k_dat2$m11_p <- 0
k_dat2$m11_p[k_dat2$m11 > 42.857] <- 1
k_dat2$m12_p<- 0
k_dat2$m12_p[k_dat2$m12 > 1.923] <- 1
k_dat2$m18_p <- 0
k_dat2$m18_p[k_dat2$m18 < 3.191] <- 1
k_dat2$m18_v <- 0
k_dat2$m18_v[k_dat2$m18 > 4.141] <- 1
k_dat2$m19_p <- 0
k_dat2$m19_p[k_dat2$m19 < 2.790] <- 1
k_dat2$m19_v <- 0
k_dat2$m19_v[k_dat2$m19 > 3.821] <- 1
k_dat2$m20_p <- 0
k_dat2$m20_p[k_dat2$m20 < 3.500] <- 1
k_dat2$m20_v <- 0
k_dat2$m20_v[k_dat2$m20 > 4.190] <- 1
k_dat2$m21_p <- 0
k_dat2$m21_p[k_dat2$m21 < 3.091] <- 1
k_dat2$m21_v <- 0
k_dat2$m21_v[k_dat2$m21 > 3.781] <- 1
k_dat2$m23_p <- 0
k_dat2$m23_p[k_dat2$m23 < 3.230] <- 1
k_dat2$m23_v <- 0
k_dat2$m23_v[k_dat2$m23 > 4.193] <- 1
k_dat2$m24_p <- 0
k_dat2$m24_p[k_dat2$m24 < 3.268] <- 1
k_dat2$m24_v <- 0
k_dat2$m24_v[k_dat2$m24 > 4.152] <- 1
k_dat2$m67_p <- 0
k_dat2$m67_p[k_dat2$m67 > 18.750] <- 1
k_dat2$m31_p <- 0
k_dat2$m31_p[k_dat2$m31 > 20.00] <- 1
k_dat2$m26_p <- 0
k_dat2$m26_p[k_dat2$m26 > 8.511] <- 1
k_dat2$m27_p <- 0
k_dat2$m27_p[k_dat2$m27 > 5.00] <- 1
k_dat2$m28_p <- 0
k_dat2$m28_p[k_dat2$m28 > 9.380] <- 1
k_dat2$m29_p <- 0
k_dat2$m29_p[k_dat2$m29 > 12.903] <- 1
k_dat2$m30_p <- 0
k_dat2$m30_p[k_dat2$m30 > 9.091] <- 1
k_dat2$m55_p <- 0
k_dat2$m55_p[k_dat2$m55 > 25.00] <- 1
k_dat2$m32_p <- 0
k_dat2$m32_p[k_dat2$m32 < 3.088] <- 1
k_dat2$m32_v <- 0
k_dat2$m32_v[k_dat2$m32 > 4.140] <- 1
k_dat2$m68_p <- 0
k_dat2$m68_p[k_dat2$m68 < 3.385] <- 1
k_dat2$m68_v <- 0
k_dat2$m68_v[k_dat2$m68 > 4.667] <- 1
k_dat2$m22_p <- 0
k_dat2$m22_p[k_dat2$m22 < 3.136] <- 1
k_dat2$m22_v <- 0
k_dat2$m22_v[k_dat2$m22 > 4.135] <- 1
k_dat2$m33_p <- 0
k_dat2$m33_p[k_dat2$m33 < 3.262] <- 1
k_dat2$m33_v <- 0
k_dat2$m33_v[k_dat2$m33 > 4.369] <- 1
k_dat2$m34_p <- 0
k_dat2$m34_p[k_dat2$m34 < 2.656] <- 1
k_dat2$m34_v <- 0
k_dat2$m34_v[k_dat2$m34 > 3.612] <- 1
k_dat2$m35_p <- 0
k_dat2$m35_p[k_dat2$m35 < 28.571] <- 1
k_dat2$m35_v <- 0
k_dat2$m35_v[k_dat2$m35 > 96.667] <- 1
k_dat2$m36_p <- 0
k_dat2$m36_p[k_dat2$m36 < 16.667] <- 1
k_dat2$m36_v <- 0
k_dat2$m36_v[k_dat2$m36 > 66.667] <- 1
k_dat2$m46_p <- 0
k_dat2$m46_p[k_dat2$m46 < 42.857] <- 1
k_dat2$m46_v  <- 0
k_dat2$m46_v[k_dat2$m46 >= 100] <- 1
k_dat2$m13_p <- 0
k_dat2$m13_p[k_dat2$m13 < 42.222] <- 1
k_dat2$m13_v <- 0
k_dat2$m13_v[k_dat2$m13 > 85.714] <- 1
k_dat2$m49_p <- 0
k_dat2$m49_p[k_dat2$m49 > 70.00] <- 1
k_dat2$m14_p <- 0
k_dat2$m14_p[k_dat2$m14 < 26.667] <- 1
k_dat2$m14_v <- 0
k_dat2$m14_v[k_dat2$m14 > 64.706] <- 1
k_dat2$m57_p <- 0
k_dat2$m57_p[k_dat2$m57 < 51.500] <- 1
k_dat2$m57_v <- 0
k_dat2$m57_v[k_dat2$m57 > 88.588] <- 1
k_dat2$m17_p <- 0
k_dat2$m17_p[k_dat2$m17 < 55.556] <- 1
k_dat2$m17_v <- 0
k_dat2$m17_v[k_dat2$m17 > 94.118] <- 1
k_dat2$m69_p <- 0
k_dat2$m69_p[k_dat2$m69 < 4.355] <- 1
k_dat2$m69_v<- 0
k_dat2$m69_v[k_dat2$m69 > 5.399] <- 1

k_dat2$k_v_sum <- k_dat2$m1_v + k_dat2$m3_v  + k_dat2$m48_v + k_dat2$m18_v + k_dat2$m19_v + k_dat2$m20_v + k_dat2$m21_v + k_dat2$m23_v + k_dat2$m24_v  + k_dat2$m32_v + k_dat2$m68_v + k_dat2$m22_v + k_dat2$m33_v + k_dat2$m35_v + k_dat2$m36_v + k_dat2$m46_v + k_dat2$m13_v + k_dat2$m69_v + k_dat2$m14_v + k_dat2$m57_v + k_dat2$m17_v



k_dat2$p_sum <- k_dat2$m1_p + k_dat2$m2_p + k_dat2$m3_p + k_dat2$m3_p + k_dat2$m4_p + k_dat2$m66_p +
k_dat2$m8_p + k_dat2$m48_p + k_dat2$m54_p + k_dat2$m9_p + k_dat2$m10_p + k_dat2$m11_p +
k_dat2$m12_p + k_dat2$m18_p + k_dat2$m19_p + k_dat2$m20_p + k_dat2$m21_p + k_dat2$m23_p +
  k_dat2$m24_p + k_dat2$m67_p + k_dat2$m31_p + k_dat2$m26_p + k_dat2$m27_p + k_dat2$m28_p +
  k_dat2$m29_p + k_dat2$m30_p + k_dat2$m55_p + k_dat2$m32_p + k_dat2$m68_p + k_dat2$m22_p + k_dat2$m33_p +
  k_dat2$m35_p + k_dat2$m36_p + k_dat2$m46_p + k_dat2$m13_p + k_dat2$m49_p + k_dat2$m14_p + k_dat2$m57_p + k_dat2$m17_p

hist(k_dat2$p_sum, breaks=20)
summary(k_dat2$p_sum)

k_dat2$k1_toimenpide[is.na(k_dat2$k1_m)] <- 0
k_dat2$k1_toimenpide[k_dat2$k1_m != 0] <- 1
k_dat2$k2_toimenpide[is.na(k_dat2$k2_m)] <- 0
k_dat2$k2_toimenpide[k_dat2$k2_m != 0] <- 1
k_dat2$k3_toimenpide[is.na(k_dat2$k3_m)] <- 0
k_dat2$k3_toimenpide[k_dat2$k3_m != 0] <- 1
k_dat2$k_toimenpide_all_n <- k_dat2$k1_toimenpide + k_dat2$k2_toimenpide + k_dat2$k3_toimenpide
hist(k_dat2$k_toimenpide_all_n)

plot(k_dat2$p_sum, k_dat2$k_toimenpide_all_n)
library(Hmisc)
rcorr(k_dat2$k_toimenpide_all_n, k_dat2$p_sum, type="pearson")

## Ja sama kokok aineistolle
s_dat00 <-  s_dat[ which(s_dat$saajia >1), ]
s_dat00$kunta <- substr(s_dat00$tyopaikka, start = 1, stop = 2)
s_dat01 <- s_dat00[which(s_dat00$kunta !="33"),]
s_dat2 <- s_dat01[-1,]
s_dat2$m1_p <- 0
s_dat2$m1_p[s_dat2$m1 < 2.004] <- 1
s_dat2$m1_v <- 0
s_dat2$m1_v[s_dat2$m1 > 3.539] <- 1
s_dat2$m2_p <- 0
s_dat2$m2_p[s_dat2$m2 > 3.830] <- 1
s_dat2$m3_p<- 0
s_dat2$m3_p[s_dat2$m3 < 3.267] <- 1
s_dat2$m3_v <- 0
s_dat2$m3_v[s_dat2$m3 > 4.072] <- 1
s_dat2$m4_p <- 0
s_dat2$m4_p[s_dat2$m4 > 47.368] <- 1
s_dat2$m66_p <- 0
s_dat2$m66_p[s_dat2$m66 > 58.824] <- 1
s_dat2$m8_p <- 0
s_dat2$m8_p[s_dat2$m8 > 2.625] <- 1
s_dat2$m48_v<- 0
s_dat2$m48_v[s_dat2$m48 > 0.714] <- 1
s_dat2$m48_p <- 0
s_dat2$m48_p[s_dat2$m48 < -0.682] <- 1
s_dat2$m54_p <- 0
s_dat2$m54_p[s_dat2$m54 > 63.636] <- 1
s_dat2$m9_p <- 0
s_dat2$m9_p[s_dat2$m9 > 40.909] <- 1
s_dat2$m10_p <- 0
s_dat2$m10_p[s_dat2$m10 > 48.485] <- 1
s_dat2$m11_p <- 0
s_dat2$m11_p[s_dat2$m11 > 42.857] <- 1
s_dat2$m12_p<- 0
s_dat2$m12_p[s_dat2$m12 > 1.923] <- 1
s_dat2$m18_p <- 0
s_dat2$m18_p[s_dat2$m18 < 3.191] <- 1
s_dat2$m18_v <- 0
s_dat2$m18_v[s_dat2$m18 > 4.141] <- 1
s_dat2$m19_p <- 0
s_dat2$m19_p[s_dat2$m19 < 2.790] <- 1
s_dat2$m19_v <- 0
s_dat2$m19_v[s_dat2$m19 > 3.821] <- 1
s_dat2$m20_p <- 0
s_dat2$m20_p[s_dat2$m20 < 3.500] <- 1
s_dat2$m20_v <- 0
s_dat2$m20_v[s_dat2$m20 > 4.190] <- 1
s_dat2$m21_p <- 0
s_dat2$m21_p[s_dat2$m21 < 3.091] <- 1
s_dat2$m21_v <- 0
s_dat2$m21_v[s_dat2$m21 > 3.781] <- 1
s_dat2$m23_p <- 0
s_dat2$m23_p[s_dat2$m23 < 3.230] <- 1
s_dat2$m23_v <- 0
s_dat2$m23_v[s_dat2$m23 > 4.193] <- 1
s_dat2$m24_p <- 0
s_dat2$m24_p[s_dat2$m24 < 3.268] <- 1
s_dat2$m24_v <- 0
s_dat2$m24_v[s_dat2$m24 > 4.152] <- 1
s_dat2$m67_p <- 0
s_dat2$m67_p[s_dat2$m67 > 18.750] <- 1
s_dat2$m31_p <- 0
s_dat2$m31_p[s_dat2$m31 > 20.00] <- 1
s_dat2$m26_p <- 0
s_dat2$m26_p[s_dat2$m26 > 8.511] <- 1
s_dat2$m27_p <- 0
s_dat2$m27_p[s_dat2$m27 > 5.00] <- 1
s_dat2$m28_p <- 0
s_dat2$m28_p[s_dat2$m28 > 9.380] <- 1
s_dat2$m29_p <- 0
s_dat2$m29_p[s_dat2$m29 > 12.903] <- 1
s_dat2$m30_p <- 0
s_dat2$m30_p[s_dat2$m30 > 9.091] <- 1
s_dat2$m55_p <- 0
s_dat2$m55_p[s_dat2$m55 > 25.00] <- 1
s_dat2$m32_p <- 0
s_dat2$m32_p[s_dat2$m32 < 3.088] <- 1
s_dat2$m32_v <- 0
s_dat2$m32_v[s_dat2$m32 > 4.140] <- 1
s_dat2$m68_p <- 0
s_dat2$m68_p[s_dat2$m68 < 3.385] <- 1
s_dat2$m68_v <- 0
s_dat2$m68_v[s_dat2$m68 > 4.667] <- 1
s_dat2$m22_p <- 0
s_dat2$m22_p[s_dat2$m22 < 3.136] <- 1
s_dat2$m22_v <- 0
s_dat2$m22_v[s_dat2$m22 > 4.135] <- 1
s_dat2$m33_p <- 0
s_dat2$m33_p[s_dat2$m33 < 3.262] <- 1
s_dat2$m33_v <- 0
s_dat2$m33_v[s_dat2$m33 > 4.369] <- 1
s_dat2$m34_p <- 0
s_dat2$m34_p[s_dat2$m34 < 2.656] <- 1
s_dat2$m34_v <- 0
s_dat2$m34_v[s_dat2$m34 > 3.612] <- 1
s_dat2$m35_p <- 0
s_dat2$m35_p[s_dat2$m35 < 28.571] <- 1
s_dat2$m35_v <- 0
s_dat2$m35_v[s_dat2$m35 > 96.667] <- 1
s_dat2$m36_p <- 0
s_dat2$m36_p[s_dat2$m36 < 16.667] <- 1
s_dat2$m36_v <- 0
s_dat2$m36_v[s_dat2$m36 > 66.667] <- 1
s_dat2$m46_p <- 0
s_dat2$m46_p[s_dat2$m46 < 42.857] <- 1
s_dat2$m46_v  <- 0
s_dat2$m46_v[s_dat2$m46 >= 100] <- 1
s_dat2$m13_p <- 0
s_dat2$m13_p[s_dat2$m13 < 42.222] <- 1
s_dat2$m13_v <- 0
s_dat2$m13_v[s_dat2$m13 > 85.714] <- 1
s_dat2$m49_p <- 0
s_dat2$m49_p[s_dat2$m49 > 70.00] <- 1
s_dat2$m14_p <- 0
s_dat2$m14_p[s_dat2$m14 < 26.667] <- 1
s_dat2$m14_v <- 0
s_dat2$m14_v[s_dat2$m14 > 64.706] <- 1
s_dat2$m57_p <- 0
s_dat2$m57_p[s_dat2$m57 < 51.500] <- 1
s_dat2$m57_v <- 0
s_dat2$m57_v[s_dat2$m57 > 88.588] <- 1
s_dat2$m17_p <- 0
s_dat2$m17_p[s_dat2$m17 < 55.556] <- 1
s_dat2$m17_v <- 0
s_dat2$m17_v[s_dat2$m17 > 94.118] <- 1
s_dat2$m69_p <- 0
s_dat2$m69_p[s_dat2$m69 < 4.355] <- 1
s_dat2$m69_v<- 0
s_dat2$m69_v[s_dat2$m69 > 5.399] <- 1



s_dat2$k_v_sum <- s_dat2$m1_v + s_dat2$m3_v  + s_dat2$m48_v + s_dat2$m18_v + s_dat2$m19_v + s_dat2$m20_v + s_dat2$m21_v + s_dat2$m23_v + s_dat2$m24_v  + s_dat2$m32_v + s_dat2$m68_v + s_dat2$m22_v + s_dat2$m33_v + s_dat2$m35_v + s_dat2$m36_v + s_dat2$m46_v + s_dat2$m13_v + s_dat2$m69_v + s_dat2$m14_v + s_dat2$m57_v + s_dat2$m17_v + s_dat2$m69_v

s_dat2$p_sum <- s_dat2$m1_p + s_dat2$m2_p + s_dat2$m3_p + s_dat2$m3_p + s_dat2$m4_p + s_dat2$m66_p +
  s_dat2$m8_p + s_dat2$m48_p + s_dat2$m54_p + s_dat2$m9_p + s_dat2$m10_p + s_dat2$m11_p +
  s_dat2$m12_p + s_dat2$m18_p + s_dat2$m19_p + s_dat2$m20_p + s_dat2$m21_p + s_dat2$m23_p +
  s_dat2$m24_p + s_dat2$m67_p + s_dat2$m31_p + s_dat2$m26_p + s_dat2$m27_p + s_dat2$m28_p +
  s_dat2$m29_p + s_dat2$m30_p + s_dat2$m55_p + s_dat2$m32_p + s_dat2$m68_p + s_dat2$m22_p + s_dat2$m33_p +
  s_dat2$m35_p + s_dat2$m36_p + s_dat2$m46_p + s_dat2$m13_p + s_dat2$m49_p  + s_dat2$m69_p + s_dat2$m14_p + s_dat2$m57_p + s_dat2$m17_p

## tilastomallit selitt?jist?

k_dat2$k_tyon_hallinta <- 0
k_dat2$k_tyon_hallinta[k_dat2$k1_m=="M3" | k_dat2$k2_m=="M3"| k_dat2$k3_m=="M3"] <- 1

k_dat2$k_vva <- 0
k_dat2$k_vva[k_dat2$k1_m=="M54" | k_dat2$k2_m=="M54"| k_dat2$k3_m=="M54"] <- 1

k_dat2$k_auttaminentaminen <- 0
k_dat2$k_auttaminentaminen[k_dat2$k1_m=="M18" | k_dat2$k2_m=="M18"| k_dat2$k3_m=="M18"] <- 1

k_dat2$k_ilmapiiri <- 0
k_dat2$k_ilmapiiri[k_dat2$k1_m=="M23" | k_dat2$k2_m=="M23"| k_dat2$k3_m=="M23"] <- 1

k_dat2$k_wtc <- 0
k_dat2$k_wtc[k_dat2$k1_m=="M1" | k_dat2$k2_m=="M1"| k_dat2$k3_m=="M1"] <- 1

k_dat2$k_t_pain <- 0
k_dat2$k_t_pain[k_dat2$k1_m=="M2" | k_dat2$k2_m=="M2"| k_dat2$k3_m=="M2"] <- 1

k_dat2$k_m4 <- 0
k_dat2$k_m4[k_dat2$k1_m=="M4" | k_dat2$k2_m=="M4"| k_dat2$k3_m=="M4"] <- 1

k_dat2$k_m66 <- 0
k_dat2$k_m66[k_dat2$k1_m=="M66" | k_dat2$k2_m=="M66"| k_dat2$k3_m=="M66"] <- 1

k_dat2$k_m8 <- 0
k_dat2$k_m8[k_dat2$k1_m=="M8" | k_dat2$k2_m=="M8"| k_dat2$k3_m=="M8"] <- 1

k_dat2$k_m47 <- 0
k_dat2$k_m47[k_dat2$k1_m=="M47" | k_dat2$k2_m=="M47"| k_dat2$k3_m=="M47"] <- 1

k_dat2$k_m48 <- 0
k_dat2$k_m48[k_dat2$k1_m=="M48" | k_dat2$k2_m=="M48"| k_dat2$k3_m=="M48"] <- 1

k_dat2$k_m54 <- 0
k_dat2$k_m54[k_dat2$k1_m=="M54" | k_dat2$k2_m=="M54"| k_dat2$k3_m=="M54"] <- 1

k_dat2$k_m9 <- 0
k_dat2$k_m9[k_dat2$k1_m=="M9" | k_dat2$k2_m=="M9"| k_dat2$k3_m=="M9"] <- 1

k_dat2$k_m10 <- 0
k_dat2$k_m10[k_dat2$k1_m=="M10" | k_dat2$k2_m=="M10"| k_dat2$k3_m=="M10"] <- 1

k_dat2$k_m11 <- 0
k_dat2$k_m11[k_dat2$k1_m=="M11" | k_dat2$k2_m=="M11"| k_dat2$k3_m=="M11"] <- 1

k_dat2$k_m12 <- 0
k_dat2$k_m12[k_dat2$k1_m=="M12" | k_dat2$k2_m=="M12"| k_dat2$k3_m=="M12"] <- 1

k_dat2$k_m19 <- 0
k_dat2$k_m19[k_dat2$k1_m=="M19" | k_dat2$k2_m=="M19"| k_dat2$k3_m=="M19"] <- 1

k_dat2$k_m20 <- 0
k_dat2$k_m20[k_dat2$k1_m=="M20" | k_dat2$k2_m=="M20"| k_dat2$k3_m=="M20"] <- 1

k_dat2$k_m21 <- 0
k_dat2$k_m21[k_dat2$k1_m=="M21" | k_dat2$k2_m=="M21"| k_dat2$k3_m=="M21"] <- 1

k_dat2$k_m24 <- 0
k_dat2$k_m24[k_dat2$k1_m=="M24" | k_dat2$k2_m=="M24"| k_dat2$k3_m=="M24"] <- 1

k_dat2$k_m67 <- 0
k_dat2$k_m67[k_dat2$k1_m=="M67" | k_dat2$k2_m=="M67"| k_dat2$k3_m=="M67"] <- 1

k_dat2$k_m31 <- 0
k_dat2$k_m31[k_dat2$k1_m=="M31" | k_dat2$k2_m=="M31"| k_dat2$k3_m=="M31"] <- 1

k_dat2$k_m26 <- 0
k_dat2$k_m26[k_dat2$k1_m=="M26" | k_dat2$k2_m=="M26"| k_dat2$k3_m=="M26"] <- 1

k_dat2$k_m27 <- 0
k_dat2$k_m27[k_dat2$k1_m=="M27" | k_dat2$k2_m=="M27"| k_dat2$k3_m=="M27"] <- 1

k_dat2$k_m28 <- 0
k_dat2$k_m28[k_dat2$k1_m=="M28" | k_dat2$k2_m=="M28"| k_dat2$k3_m=="M28"] <- 1

k_dat2$k_m29 <- 0
k_dat2$k_m29[k_dat2$k1_m=="M29" | k_dat2$k2_m=="M29"| k_dat2$k3_m=="M29"] <- 1

k_dat2$k_m30 <- 0
k_dat2$k_m30[k_dat2$k1_m=="M30" | k_dat2$k2_m=="M30"| k_dat2$k3_m=="M30"] <- 1

k_dat2$k_m55 <- 0
k_dat2$k_m55[k_dat2$k1_m=="M55" | k_dat2$k2_m=="M55"| k_dat2$k3_m=="M55"] <- 1

k_dat2$k_m32 <- 0
k_dat2$k_m32[k_dat2$k1_m=="M32" | k_dat2$k2_m=="M32"| k_dat2$k3_m=="M32"] <- 1

k_dat2$k_m68 <- 0
k_dat2$k_m68[k_dat2$k1_m=="M68" | k_dat2$k2_m=="M68"| k_dat2$k3_m=="M68"] <- 1

k_dat2$k_m22 <- 0
k_dat2$k_m22[k_dat2$k1_m=="M22" | k_dat2$k2_m=="M22"| k_dat2$k3_m=="M22"] <- 1

k_dat2$k_m33 <- 0
k_dat2$k_m33[k_dat2$k1_m=="M33" | k_dat2$k2_m=="M33"| k_dat2$k3_m=="M33"] <- 1

k_dat2$k_m34 <- 0
k_dat2$k_m34[k_dat2$k1_m=="M34" | k_dat2$k2_m=="M34"| k_dat2$k3_m=="M34"] <- 1

k_dat2$k_m35 <- 0
k_dat2$k_m35[k_dat2$k1_m=="M35" | k_dat2$k2_m=="M35"| k_dat2$k3_m=="M35"] <- 1

k_dat2$k_m36 <- 0
k_dat2$k_m36[k_dat2$k1_m=="M36" | k_dat2$k2_m=="M36"| k_dat2$k3_m=="M36"] <- 1

k_dat2$k_m38 <- 0
k_dat2$k_m38[k_dat2$k1_m=="M38" | k_dat2$k2_m=="M38"| k_dat2$k3_m=="M38"] <- 1

k_dat2$k_m39 <- 0
k_dat2$k_m39[k_dat2$k1_m=="M39" | k_dat2$k2_m=="M39"| k_dat2$k3_m=="M39"] <- 1

k_dat2$k_m41 <- 0
k_dat2$k_m41[k_dat2$k1_m=="M41" | k_dat2$k2_m=="M41"| k_dat2$k3_m=="M41"] <- 1

k_dat2$k_m42 <- 0
k_dat2$k_m42[k_dat2$k1_m=="M42" | k_dat2$k2_m=="M42"| k_dat2$k3_m=="M42"] <- 1

k_dat2$k_m43 <- 0
k_dat2$k_m43[k_dat2$k1_m=="M43" | k_dat2$k2_m=="M43"| k_dat2$k3_m=="M43"] <- 1

k_dat2$k_m44 <- 0
k_dat2$k_m44[k_dat2$k1_m=="M44" | k_dat2$k2_m=="M44"| k_dat2$k3_m=="M44"] <- 1

k_dat2$k_m45 <- 0
k_dat2$k_m45[k_dat2$k1_m=="M45" | k_dat2$k2_m=="M45"| k_dat2$k3_m=="M45"] <- 1

k_dat2$k_m46 <- 0
k_dat2$k_m46[k_dat2$k1_m=="M46" | k_dat2$k2_m=="M46"| k_dat2$k3_m=="M46"] <- 1

k_dat2$k_m13 <- 0
k_dat2$k_m13[k_dat2$k1_m=="M13" | k_dat2$k2_m=="M13"| k_dat2$k3_m=="M13"] <- 1

k_dat2$k_m69 <- 0
k_dat2$k_m69[k_dat2$k1_m=="M69" | k_dat2$k2_m=="M69"| k_dat2$k3_m=="M69"] <- 1

k_dat2$k_m49 <- 0
k_dat2$k_m49[k_dat2$k1_m=="M49" | k_dat2$k2_m=="M49"| k_dat2$k3_m=="M49"] <- 1

k_dat2$k_m14 <- 0
k_dat2$k_m14[k_dat2$k1_m=="M14" | k_dat2$k2_m=="M14"| k_dat2$k3_m=="M14"] <- 1

k_dat2$k_m57 <- 0
k_dat2$k_m57[k_dat2$k1_m=="M57" | k_dat2$k2_m=="M57"| k_dat2$k3_m=="M57"] <- 1

k_dat2$k_m15 <- 0
k_dat2$k_m15[k_dat2$k1_m=="M15" | k_dat2$k2_m=="M15"| k_dat2$k3_m=="M15"] <- 1

k_dat2$k_m16 <- 0
k_dat2$k_m16[k_dat2$k1_m=="M16" | k_dat2$k2_m=="M16"| k_dat2$k3_m=="M16"] <- 1

k_dat2$k_m17 <- 0
k_dat2$k_m17[k_dat2$k1_m=="M17" | k_dat2$k2_m=="M17"| k_dat2$k3_m=="M17"] <- 1

k_dat2$k_m50 <- 0
k_dat2$k_m50[k_dat2$k1_m=="M50" | k_dat2$k2_m=="M50"| k_dat2$k3_m=="M50"] <- 1

k_dat2$k_m51 <- 0
k_dat2$k_m51[k_dat2$k1_m=="M51" | k_dat2$k2_m=="M51"| k_dat2$k3_m=="M51"] <- 1

k_dat2$k_m52 <- 0
k_dat2$k_m52[k_dat2$k1_m=="M52" | k_dat2$k2_m=="M52"| k_dat2$k3_m=="M52"] <- 1

k_dat2$k_m58 <- 0
k_dat2$k_m58[k_dat2$k1_m=="M58" | k_dat2$k2_m=="M58"| k_dat2$k3_m=="M58"] <- 1

k_dat2$k_m59 <- 0
k_dat2$k_m59[k_dat2$k1_m=="M59" | k_dat2$k2_m=="M59"| k_dat2$k3_m=="M59"] <- 1

k_dat2$k_m60 <- 0
k_dat2$k_m60[k_dat2$k1_m=="M60" | k_dat2$k2_m=="M60"| k_dat2$k3_m=="M60"] <- 1

k_dat2$k_m61 <- 0
k_dat2$k_m61[k_dat2$k1_m=="M61" | k_dat2$k2_m=="M61"| k_dat2$k3_m=="M61"] <- 1

k_dat2$k_m62 <- 0
k_dat2$k_m62[k_dat2$k1_m=="M62" | k_dat2$k2_m=="M62"| k_dat2$k3_m=="M62"] <- 1

k_dat2$k_vva_all <- 0
k_dat2$k_vva_all[k_dat2$k_vva==1 | k_dat2$k_m9==1| k_dat2$k_m10==1 | k_dat2$k_m11==1 | k_dat2$k_m12==1] <- 1

k_dat2$k_syr_all <- 0
k_dat2$k_syr_all[k_dat2$k_m67==1 | k_dat2$k_m31==1| k_dat2$k_m26==1 | k_dat2$k_m27==1 | k_dat2$k_m28==1 | k_dat2$k_m29==1 | k_dat2$k_m30==1] <- 1


require(MASS)

model <- glm(k_dat2$k_tyon_hallinta ~ k_dat2$m3_p,family=binomial(link='logit'),data=k_dat2)
summary(model)
exp(cbind(coef(model), confint(model)))  

model2 <- glm(k_dat2$k_vva ~ k_dat2$m54_p,family=binomial(link='logit'),data=k_dat2)
summary(model2)
exp(cbind(coef(model2), confint(model2)))  

model3 <- glm(k_dat2$k_auttaminentaminen ~ k_dat2$m18_p,family=binomial(link='logit'),data=k_dat2)
summary(model3)
exp(cbind(coef(model3), confint(model3)))  

model4 <- glm(k_dat2$k_ilmapiiri ~ k_dat2$m23_p,family=binomial(link='logit'),data=k_dat2)
summary(model4)
exp(cbind(coef(model4), confint(model4)))  


library(gmodels)
CrossTable(k_dat2$k_tyon_hallinta, k_dat2$m3_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)

CrossTable(k_dat2$k_vva, k_dat2$m54_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)
CrossTable(k_dat2$k_auttaminen, k_dat2$m18_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)
CrossTable(k_dat2$k_ilmapiiri, k_dat2$m23_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)



```

## Taustamuuttujien jakauma

Koko aineiston kaikkien ty?yksik?iden jakaumat taustamuuttujittain verraten ty?yksik?it? jotka kirjasivat kehitt?mistoimenpiteit?, ja niit? jotka eiv?t niin tehneet

```{r, echo=FALSE}
library(ggplot2)
# Kernel density plots for mpg
# grouped by number of gears (indicated by color)
s_dat2$kehto_l <- factor(s_dat2$kehto,levels=c(0,1),
                      labels=c("ei merkit?j?","merkint?j?")) 
qplot(M63, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="keskik?", xlab="Ty?ntekij?iden keski-ik?",
      ylab="Density")
summary(s_dat2$M63)
summary(k_dat2$M63)
qplot(M64, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Naisten osuus", xlab="Naisten osuus",
      ylab="Density")
summary(s_dat2$M64)
summary(k_dat2$M64)
qplot(M65, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="M??r?aikaisten osuus", xlab="M??r?aikaisten osuus",
      ylab="Density")
summary(s_dat2$M65)
summary(k_dat2$M65)

qplot(saajia, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Ty?paika koon mukaan", xlab="Ty?paika koko",
      ylab="Density")
summary(s_dat2$saajia)
summary(k_dat2$saajia)

```

## Datan arvojen jakauma

Seuraavaksi nelj?n t?rkeimm?n muuttujan jakaumat sek? kehtolaisille ett? muille

```{r, echo=FALSE}
# Kernel density plots for kehto
# grouped by kehto (indicated by color)
s_dat2$kehto_l <- factor(s_dat2$kehto,levels=c(0,1),
                      labels=c("ei merkint?j?","merkint?j?")) 
qplot(m3, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Ty?nhallinta", xlab="Ty?nhallinta",
      ylab="Density")

summary(s_dat2$m3)
summary(k_dat2$m3)
t.test(s_dat2$m3~s_dat2$kehto)

tp1 <- qplot(m3, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Ty?nhallinta", xlab="Ty?nhallinta",
      ylab="Density")

# Histogram of muuttuja, divided by kehto and kunta
tp1 + facet_grid( ~ kunta)




qplot(m54, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="V?kivalta asiakkailta", xlab="V?kivalta asiakkailta",
      ylab="Density")

summary(s_dat2$m54)
summary(k_dat2$m54)
t.test(s_dat2$m54~s_dat2$kehto)


tp2 <- qplot(m54, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="V?kivalta asiakkailta", xlab="V?kivalta asiakkailta",
      ylab="Density")

# Histogram of muuttuja, divided by kehto and kunta
tp2 + facet_grid( ~ kunta)


qplot(m18, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Ty?yhteis?taidot: auttaminen ja huomaavaisuus", xlab="Ty?yhteis?taidot: auttaminen ja huomaavaisuus",
      ylab="Density")

summary(s_dat2$m18)
summary(k_dat2$m18)
t.test(s_dat2$m18~s_dat2$kehto)

tp3 <- qplot(m18, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Ty?yhteis?taidot: auttaminen ja huomaavaisuus", xlab="Ty?yhteis?taidot: auttaminen ja huomaavaisuus",
      ylab="Density")

# Histogram of muuttuja, divided by kehto and kunta
tp3 + facet_grid( ~ kunta)




qplot(m23, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Ty?paikan ilmapiiri", xlab="Ty?paikan ilmapiiri",
      ylab="Density")


tp4 <- qplot(m23, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Ty?paikan ilmapiiri", xlab="Ty?paikan ilmapiiri",
      ylab="Density")

# Histogram of muuttuja, divided by kehto and kunta
tp4 + facet_grid( ~ kunta)



summary(s_dat2$m23)
summary(k_dat2$m23)
t.test(s_dat2$m23~s_dat2$kehto)


qplot(m1, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Ty?aikojen hallinta", 
      ylab="Density")


tp5 <- qplot(m1, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Ty?aikojen hallinta", 
      ylab="Density")
tp5 + facet_grid( ~ kunta)

qplot(m2, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Ty?paineet", 
      ylab="Density")


tp6 <- qplot(m2, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Ty?paineet", 
      ylab="Density")
tp6 + facet_grid( ~ kunta)

qplot(m4, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Ty?paineita paljon, hallintaa v?h?n", 
      ylab="Density")


tp7 <- qplot(m4, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Ty?paineita paljon, hallintaa v?h?n", 
      ylab="Density")
tp7 + facet_grid( ~ kunta)


qplot(m66, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Ty?maa?r?n lis??ntyminen", 
      ylab="Density")


tp8 <- qplot(m66, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Ty?m??r?n lis??ntyminen", 
      ylab="Density")
tp8 + facet_grid( ~ kunta)

qplot(m8, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Ty?n ep?varmuus", 
      ylab="Density")


tp9 <- qplot(m8, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Ty?n ep?varmuus", 
      ylab="Density")
tp9 + facet_grid( ~ kunta)

qplot(m47, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Muutokset ty?ss?: suuruus", 
      ylab="Density")
tp10 <- qplot(m47, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Muutokset ty?ss?: suuruus", 
      ylab="Density")
tp10 + facet_grid( ~ kunta)

qplot(m48, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Muutokset ty?ss?: laatu", 
      ylab="Density")
tp11 <- qplot(m46, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Muutokset ty?ss?: laatu", 
      ylab="Density")
tp11 + facet_grid( ~ kunta)


qplot(m9, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Asiakas v?kivalta: tavaroiden heittely", 
      ylab="Density")
tp13 <- qplot(m9, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Asiakasv?kivalta:tavaroiden heittely", 
      ylab="Density")
tp13 + facet_grid( ~ kunta)

qplot(m10, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Asiakas v?kivalta: henkinen", 
      ylab="Density")
tp14 <- qplot(m10, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Asiakasv?kivalta: henkinen", 
      ylab="Density")
tp14 + facet_grid( ~ kunta)

qplot(m11, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Asiakas v?kivalta: ly?minen", 
      ylab="Density")
tp15 <- qplot(m11, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Asiakasv?kivalta: ly?minen", 
      ylab="Density")
tp15 + facet_grid( ~ kunta)

qplot(m12, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Asiakas v?kivalta: aseella uhkaaminen", 
      ylab="Density")
tp16 <- qplot(m12, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Asiakasv?kivalta: aseella uhkaaminen", 
      ylab="Density")
tp16 + facet_grid( ~ kunta)

qplot(m19, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Ty?yhteis?taidot: innovatiivisuus", 
      ylab="Density")
tp17 <- qplot(m19, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Ty?yhteis?taidot: innovatiivisuus", 
      ylab="Density")
tp17 + facet_grid( ~ kunta)

qplot(m20, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Ty?yhteis?taidot: tavoitteellisuus", 
      ylab="Density")
tp18 <- qplot(m20, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Ty?yhteis?taidot: tavoitteellisuus", 
      ylab="Density")
tp18 + facet_grid( ~ kunta)

qplot(m21, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Ty?yhteis?taidot: kehitt?minen", 
      ylab="Density")
tp19 <- qplot(m21, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Ty?yhteis?taidot: Kehitt?minen", 
      ylab="Density")
tp19 + facet_grid( ~ kunta)

qplot(m24, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Sosiaallinen p??oma", 
      ylab="Density")
tp20 <- qplot(m24, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Sosiaalinen p??oma", 
      ylab="Density")
tp20 + facet_grid( ~ kunta)

qplot(m67, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Itse syrjnn?n kohteena: yhdenvertaisuus laki", 
      ylab="Density")
tp21 <- qplot(m67, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Itse syrjinn?n kohteena: yhdenvertaisuus laki", 
      ylab="Density")
tp21 + facet_grid( ~ kunta)

qplot(m31, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Itse syrjnn?n kohteena: 5 syyt?", 
      ylab="Density")
tp22 <- qplot(m31, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Itse syrjinn?n kohteena: 5 syyt?", 
      ylab="Density")
tp22 + facet_grid( ~ kunta)

qplot(m26, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Itse syrjnn?n kohteena: ik?", 
      ylab="Density")
tp23 <- qplot(m26, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Itse syrjinn?n kohteena: ik?", 
      ylab="Density")
tp23 + facet_grid( ~ kunta)

qplot(m27, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Itse syrjnn?n kohteena: sukupuoli", 
      ylab="Density")
tp24 <- qplot(m27, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Itse syrjinn?n kohteena: sukupuoli", 
      ylab="Density")
tp24 + facet_grid( ~ kunta)

qplot(m28, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Itse syrjnn?n kohteena: koulutus", 
      ylab="Density")
tp25 <- qplot(m28, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Itse syrjinn?n kohteena: koulutus", 
      ylab="Density")
tp25 + facet_grid( ~ kunta)

qplot(m29, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Itse syrjnn?n kohteena: mielipide", 
      ylab="Density")
tp26 <- qplot(m29, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Itse syrjinn?n kohteena: mielipide", 
      ylab="Density")
tp26 + facet_grid( ~ kunta)

qplot(m30, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Itse syrjnn?n kohteena: asema", 
      ylab="Density")
tp27 <- qplot(m30, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Itse syrjinn?n kohteena: asema", 
      ylab="Density")
tp27 + facet_grid( ~ kunta)

qplot(m55, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Itse ty?paikkakiusaamisen kohteen", 
      ylab="Density")
tp28 <- qplot(m55, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Itse ty?paikkakiusaamisen kohteena", 
      ylab="Density")
tp28 + facet_grid( ~ kunta)

qplot(m32, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Esimiestuki", 
      ylab="Density")
tp29 <- qplot(m32, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Esimiestuki", 
      ylab="Density")
tp29 + facet_grid( ~ kunta)

qplot(m68, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Osallistava johtaminen", 
      ylab="Density")
tp30 <- qplot(m68, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Osallisatava johtaminen", 
      ylab="Density")
tp30 + facet_grid( ~ kunta)

qplot(m22, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Ty?yhteis?n tuki esimiehelle", 
      ylab="Density")
tp31 <- qplot(m22, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Ty?yhteis?n tuki esimiehelle", 
      ylab="Density")
tp31 + facet_grid( ~ kunta)

qplot(m33, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Kohtelun oikeudenmukaisuus", 
      ylab="Density")
tp32 <- qplot(m33, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Kohtelun oikeudenmukaisuus", 
      ylab="Density")
tp32 + facet_grid( ~ kunta)

qplot(m34, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="P??t?ksenteon oikeudenmukaisuus", 
      ylab="Density")
tp33 <- qplot(m34, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="P??t?ksenteon oikeudenmukaisuus", 
      ylab="Density")
tp33 + facet_grid( ~ kunta)

qplot(m35, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Yksil?kehityskeskustelun k?yminen", 
      ylab="Density")
tp34 <- qplot(m35, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Yksil?kehityskeskustelun k?yminen", 
      ylab="Density")
tp34 + facet_grid( ~ kunta)

qplot(m36, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Yksil?kehityskeskustelun hy?dyllisyys", 
      ylab="Density")
tp35 <- qplot(m36, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Yksil?kehityskeskustelun hy?dyllisyys", 
      ylab="Density")
tp35 + facet_grid( ~ kunta)

qplot(m38, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Kehityskeskustelun sis?lt?: uudet tavoitteet", 
      ylab="Density")
tp36 <- qplot(m38, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Kehityskeskustelun sis?lt?: uudet tavoitteet", 
      ylab="Density")
tp36 + facet_grid( ~ kunta)

qplot(m39, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Kehityskeskustelun sis?lt?: kehittymismahdollisuudet", 
      ylab="Density")
tp37 <- qplot(m39, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Kehityskeskustelun sis?lt?: kehittymismahdollisuudet", 
      ylab="Density")
tp37 + facet_grid( ~ kunta)

qplot(m41, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Kehityskeskustelun sis?lt?: mielipiteen ilmaisumahdollisuus", 
      ylab="Density")
tp38 <- qplot(m41, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Kehityskeskustelun sis?lt?: mielipiteen ilmaisumahdollisuus", 
      ylab="Density")
tp38 + facet_grid( ~ kunta)

qplot(m42, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Kehityskeskustelun sis?lt?: odotukset ty?ss?", 
      ylab="Density")
tp39 <- qplot(m42, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Kehityskeskustelun sis?lt?: odotukset ty?ss?", 
      ylab="Density")
tp39 + facet_grid( ~ kunta)

qplot(m43, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Kehityskeskustelun sis?lt?: kehittymissuunnitelma", 
      ylab="Density")
tp40 <- qplot(m43, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Kehityskeskustelun sis?lt?: kehittymissuunnitelma", 
      ylab="Density")
tp40 + facet_grid( ~ kunta)

qplot(m44, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Ryhm?kehityskeskustelun k?yminen", 
      ylab="Density")
tp41 <- qplot(m44, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Ryhm?kehityskeskustelun k?yminen", 
      ylab="Density")
tp41 + facet_grid( ~ kunta)

qplot(m45, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Ryhm?kehityskeskustelun hy?dyllisyys", 
      ylab="Density")
tp42 <- qplot(m45, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Ryhm?kehityskeskustelun hy?dyllisyys", 
      ylab="Density")
tp42 + facet_grid( ~ kunta)

qplot(m46, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Yksil?- ja/tai ryhm?kehityskeskustelun k?yminen", 
      ylab="Density")
tp43 <- qplot(m46, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Yksil?- ja/tai ryhm?kehityskeskustelun k?yminen", 
      ylab="Density")
tp43 + facet_grid( ~ kunta)

qplot(m13, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="T?ydennyskoulutus riitt?v?", 
      ylab="Density")
tp44 <- qplot(m13, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="T?ydennyskoulutus riitt?v?", 
      ylab="Density")
tp44 + facet_grid( ~ kunta)

qplot(m69, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Ty?n mielekkyys", 
      ylab="Density")
tp45 <- qplot(m69, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Ty?n mielekkyys", 
      ylab="Density")
tp45 + facet_grid( ~ kunta)

qplot(m49, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Muutokset ty?ss?: ei vaikutusmahdollisuuksia", 
      ylab="Density")
tp46 <- qplot(m49, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Muutokset ty?ss?: ei vaikutusmahdollisuuksia", 
      ylab="Density")
tp46 + facet_grid( ~ kunta)

qplot(m14, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Halu jatkaa omassa ty?ss?", 
      ylab="Density")
tp47 <- qplot(m14, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Halu jatkaa omassa ty?ss?", 
      ylab="Density")
tp47 + facet_grid( ~ kunta)

qplot(m57, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Uskoo jatkavansa el?keik??n saakka", 
      ylab="Density")
tp48 <- qplot(m57, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Uskoo jatkavansa el?keik??n saakka", 
      ylab="Density")
tp48 + facet_grid( ~ kunta)

qplot(m15, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Harkinnut el?kkeelle j??mist?", 
      ylab="Density")
tp49 <- qplot(m15, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Harkinnut el?kkeelle j??mist?", 
      ylab="Density")
tp49 + facet_grid( ~ kunta)

qplot(m16, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Harkinnut ty?nantajan vaihtamista", 
      ylab="Density")
tp50 <- qplot(m16, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Harkinnut ty?nantajan vaihtamista", 
      ylab="Density")
tp50 + facet_grid( ~ kunta)

qplot(m17, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="Ty?nantajan suositteleminen", 
      ylab="Density")
tp51 <- qplot(m17, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="Ty?nantajan suositteleminen", 
      ylab="Density")
tp51 + facet_grid( ~ kunta)

qplot(m50, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="K10-tuloksia k?sitelty", 
      ylab="Density")
tp52 <- qplot(m50, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="K10-tuloksia k?sitelty", 
      ylab="Density")
tp52 + facet_grid( ~ kunta)

qplot(m51, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="K10-tulosten pohjalta tehty suunnitelmia", 
      ylab="Density")
tp53 <- qplot(m51, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="K10-tulosten pohjalta tehty suunnitelmia", 
      ylab="Density")
tp53 + facet_grid( ~ kunta)

qplot(m52, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="K10-tulosten pohjalta tehty toimenpiteit?", 
      ylab="Density")
tp54 <- qplot(m52, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="K10-tulosten pohjalta tehty toimenpiteit?", 
      ylab="Density")
tp54 + facet_grid( ~ kunta)

qplot(m53, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.5),
      main="K10-tulosten pohjalta tehtyj? toimenpiteit? seurattu", 
      ylab="Density")
tp55 <- qplot(m53, data=s_dat2, geom="density", fill=kehto_l, alpha=I(.4),
      main="K10-tulosten pohjalta tehtyj? toimenpiteit? seurattu", 
      ylab="Density")
tp55 + facet_grid( ~ kunta)




```

Yll?olevosta kuvista ei voi tarkasti sanoa mill? muuttujilla on merkitt?v? ero merkanneiden ja ei merkanneiden ty?yhteis?jen v?lill? (paitsi ehk? osassa kehityskeskustelu kuvissa). Joten olen my?s laskenut t-testit kaikille muuttujille, joissa arvioidaan merkitt?v?? eroa merkinneiden ja ei merkinneiden ty?yhteis?jen v?lill?.

Alla oleva lista n?ytt?? listan vain muuttujista joilla ryhmien v?lill? on tilastollisesti merkitt?v? ero. Muuttujia joilla ei merkitt?v?? eroa ei l?ytynyt ei ole printattu t?h?n.

```{r, echo=FALSE}
t_data <- s_dat2[c(3:7,17:70,295,297:356)]
t_s_dat2 <-  sapply(t_data[c(1:59,61:120)], function(i) t.test(i ~ t_data$kehto)$p.value)
x_1 <- data.frame(p.value= sapply(s_dat2[,17:70], function(i) t.test(i ~ s_dat2$kehto)$p.value))
x_1$muuttuja <- rownames(x_1) 
rownames(x_1) <- NULL           
x_1[x_1$p.value < 0.05/92,]

```





## Liikennevalojen jakauma

Liikennevalojen jakauma ty?yksik?iss? on suhteellisen laaja. Suuri osa ty?ykisk?ist? ei saa yht??n huomiov?ri?, kun taas punaisten huomiov?rejen maksimi on 30 (huom t?ss? muutosta viime kerrasta, sill? tajusin ett? puuttuvat arvot olivat tasan olevia raja-arvoja).

Alempi histrogrammi kuvaa vihreiden huomiov?rien jakaumaa. Vihreiss? huomiov?reiss? on my?s suuri jaukauma. Maksimissaan ty?yksikk? on saanut 21 vihreet? huomiov?ri? kun taas osalla ei ole yht??n huomiov?ri?. 


```{r pressure, echo=FALSE, warning=FALSE}
hist(s_dat2$p_sum, breaks=25)
summary(s_dat2$p_sum)

hist(s_dat2$k_v_sum, breaks = 25)
summary(s_dat2$k_v_sum)





```

Sek? vihreill? ja punaisilla huomiov?reill? on pareto jakauma. 

### Liikennevalojen jakauma kehdon tekij?iden ja tekem?tt?mien v?lill?

Jakauma on suhteellisen samanlainen sek? koko aineistolle ett?, ty?yksik?ille jotka tekiv?t kehitt?mistoimenpiteit?

```{r, echo=FALSE}
ggplot(k_dat2, aes(x = p_sum), main="Punaisten liikennevalojen jakauma") +
  geom_histogram()
summary(s_dat2$p_sum)
summary(k_dat2$p_sum)

g <- ggplot(s_dat2, aes(p_sum)) 
g+geom_bar(aes(fill=kehto_l))

ggplot(k_dat2, aes(x = k_v_sum), main="Vihreiden liikennevalojen jakauma") +
  geom_histogram()
summary(s_dat2$k_v_sum)
summary(k_dat2$k_v_sum)

g <- ggplot(s_dat2, aes(k_v_sum)) 
g+geom_bar(aes(fill=kehto_l))

```


### Todenn?k?isyys valita liikennevaloihin perustuen

Nelj?n eniten valitun kehitt?miskohteen todenn?k?isyys tulla valituksi liikennevalon perusteella.Ensin tarkastellaan punaisia liikennevaloja, ja sen j?lkeen vihreit? liikennevaloja

#### Punaiset liikennevalot

Alla olevassa analyysissa tarkastellaan vain ty?yksik?it? joilla on ainakin yksi punainen liikennevalo.

Huomio: 
*M3 = Ty?n hallinta
*M54 = V?kivalta asiakkailta
*M18 = Ty?yhteis?taido: auttaminen ja huomaavaisuus
*M23 = Ty?paika ilmapiiri

```{r, echo=FALSE}

p1 <- k_dat2[which(k_dat2$p_sum>0),]
  
CrossTable(p1$k_tyon_hallinta, p1$m3_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)


CrossTable(p1$k_vva, p1$m54_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)


CrossTable(p1$k_auttaminen, p1$m18_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)


CrossTable(p1$k_ilmapiiri, p1$m23_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)

model <- glm(p1$k_tyon_hallinta ~ p1$m3_p,family=binomial(link='logit'),data=p1)
summary(model)
exp(cbind(coef(model), confint(model)))  

model2 <- glm(p1$k_vva ~ p1$m54_p,family=binomial(link='logit'),data=p1)
summary(model2)
exp(cbind(coef(model2), confint(model2)))  

model3 <- glm(p1$k_auttaminen ~ p1$m18_p,family=binomial(link='logit'),data=p1)
summary(model3)
exp(cbind(coef(model3), confint(model3)))  

model4 <- glm(p1$k_ilmapiiri ~ p1$m23_p,family=binomial(link='logit'),data=p1)
summary(model4)
exp(cbind(coef(model4), confint(model4)))  

CrossTable(p1$k_m4, p1$m4_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)

CrossTable(p1$k_m66, p1$m66_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)
CrossTable(p1$k_m8, p1$m8_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE) 

CrossTable(p1$k_m48, p1$m48_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)

CrossTable(p1$k_m54, p1$m54_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)

CrossTable(p1$k_m9, p1$m9_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)

CrossTable(p1$k_m10, p1$m10_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)

CrossTable(p1$k_m11, p1$m11_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)

CrossTable(p1$k_m12, p1$m12_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)

CrossTable(p1$k_m19, p1$m19_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE) 


CrossTable(p1$k_m20, p1$m20_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)

CrossTable(p1$k_m21, p1$m21_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)
CrossTable(p1$k_m24, p1$m24_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)

CrossTable(p1$k_m67, p1$m67_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)

CrossTable(p1$k_m31, p1$m31_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)

CrossTable(p1$k_m26, p1$m26_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)

CrossTable(p1$k_m27, p1$m27_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)

CrossTable(p1$k_m28, p1$m28_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)

CrossTable(p1$k_m29, p1$m29_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)

CrossTable(p1$k_m30, p1$m30_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)

CrossTable(p1$k_m55, p1$m55_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)

CrossTable(p1$k_m32, p1$m32_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)

CrossTable(p1$k_m68, p1$m68_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE) 

CrossTable(p1$k_m22, p1$m22_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)

CrossTable(p1$k_m33, p1$m33_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)

CrossTable(p1$k_m34, p1$m34_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)

CrossTable(p1$k_m35, p1$m35_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)

CrossTable(p1$k_m36, p1$m36_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)

CrossTable(p1$k_m46, p1$m46_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)

CrossTable(p1$k_m13, p1$m13_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)

CrossTable(p1$k_m69, p1$m69_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)

CrossTable(p1$k_m49, p1$m49_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)

CrossTable(p1$k_m14, p1$m14_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE) 

CrossTable(p1$k_m57, p1$m57_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)

CrossTable(p1$k_m17, p1$m17_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)


```
#### vihre?t liikennevalot

Alla olevassa analyysissa tarkastellaan vain ty?yksik?it? joilla on ainakin yksi vihre? liikennevalo.

Huomio: 
*M3 = Ty?n hallinta
*M54 = V?kivalta asiakkailta
*M18 = Ty?yhteis?taido: auttaminen ja huomaavaisuus
*M23 = Ty?paika ilmapiiri

```{r, echo=FALSE}

v1 <- k_dat2[which(k_dat2$k_v_sum>0),]
  
CrossTable(v1$k_tyon_hallinta, v1$m3_v,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)



CrossTable(v1$k_auttaminen, v1$m18_v,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)


CrossTable(v1$k_ilmapiiri, v1$m23_v,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)

model <- glm(v1$k_tyon_hallinta ~ v1$m3_v,family=binomial(link='logit'),data=v1)
summary(model)
exp(cbind(coef(model), confint(model)))  

 

model3 <- glm(v1$k_auttaminen ~ v1$m18_v,family=binomial(link='logit'),data=v1)
summary(model3)
exp(cbind(coef(model3), confint(model3)))  

model4 <- glm(v1$k_ilmapiiri ~ v1$m23_v,family=binomial(link='logit'),data=v1)
summary(model4)
exp(cbind(coef(model4), confint(model4)))  



CrossTable(v1$k_m48, v1$m48_v,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)


CrossTable(v1$k_m19, v1$m19_v,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE) 


CrossTable(v1$k_m20, v1$m20_v,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)

CrossTable(v1$k_m21, v1$m21_p,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)
CrossTable(v1$k_m24, v1$m24_v,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)


CrossTable(v1$k_m32, v1$m32_v,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)

CrossTable(v1$k_m68, v1$m68_v,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE) 

CrossTable(v1$k_m22, v1$m22_v,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)

CrossTable(v1$k_m33, v1$m33_v,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)

CrossTable(v1$k_m34, v1$m34_v,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)

CrossTable(v1$k_m35, v1$m35_v,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)

CrossTable(v1$k_m36, v1$m36_v,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)

CrossTable(v1$k_m46, v1$m46_v,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)

CrossTable(v1$k_m13, v1$m13_v,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)

CrossTable(v1$k_m69, v1$m69_v,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)

CrossTable(v1$k_m14, v1$m14_v,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE) 

CrossTable(v1$k_m57, v1$m57_v,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)

CrossTable(v1$k_m17, v1$m17_v,  prop.r=T, prop.c=T,
           prop.t=FALSE, prop.chisq=F, chisq = TRUE)


```
My?s vihreill? liikennevaloilla on merkityksellinen suhde kehitt?miskohteiden valinnassa. Mutta vain ty?npaikan ilmapiiriss? olivat ty?nyhteis?t suuremmalla todenn?l?isyydell? valitsivat t?m?n kehitt?miskohteeksi. 

Kun katsoo kaikkia kehitt?mistoimenpiteit? ja niihin liittyvi? liikennevaloja, voi huomata ett? on my?s liikennevaloja joilla ei ole tilastollisesti merkitt?v?? suhdetta kehitt?mistoimenpiteeksi valitsemisen kanssa. 


## Kehitt?mistoimenpide ja muuttujan taso

Alla tarkasttellaan ty?yhteis?jen todenn?k?isyytt? valita kehitt?mistoimenpide ja kyseess? olevan muuttujan tason suhdetta.

Alle olen tehnyt mallit kaikista muuttujista. Olen tulostanut jokaisesta mallista vain interceptin ja OR:t, sek? 95% luottamusv?lit. 

Ei kannata huolestua jos jollein muuttujille on todella korkeita lukuja. Sill? lukuhan kertoo sit? ett? 'yhden asteen nousu vaikuttaa..'. Joissain muuttujissa on todella kapea jakauma, ja keskiarvossa yhden asteen muutos olisi todella huima. 


```{r, echo=FALSE}


ml1 <- glm(k_dat2$k_tyon_hallinta ~ k_dat2$m3,family=binomial(link='logit'),data=k_dat2)
m1 <-exp(cbind(coef(ml1), confint(ml1)))  

ml2 <- glm(k_dat2$k_auttaminen ~ k_dat2$m18,family=binomial(link='logit'),data=k_dat2)
m2 <-exp(cbind(coef(ml2), confint(ml2)))  

ml3 <- glm(k_dat2$k_ilmapiiri ~ k_dat2$m23,family=binomial(link='logit'),data=k_dat2)
m3<-exp(cbind(coef(ml3), confint(ml3)))  

ml4 <- glm(k_dat2$k_wtc ~ k_dat2$m1,family=binomial(link='logit'),data=k_dat2)
m4 <-exp(cbind(coef(ml4), confint(ml4)))  

ml5 <- glm(k_dat2$k_t_pain ~ k_dat2$m2,family=binomial(link='logit'),data=k_dat2)
m5 <-exp(cbind(coef(ml5), confint(ml5)))

ml6 <- glm(k_dat2$k_m4 ~ k_dat2$m4,family=binomial(link='logit'),data=k_dat2)
m6 <-exp(cbind(coef(ml6), confint(ml6))) 

ml7 <- glm(k_dat2$k_m66 ~ k_dat2$m66,family=binomial(link='logit'),data=k_dat2)
m7 <-exp(cbind(coef(ml7), confint(ml7))) 

ml8 <- glm(k_dat2$k_m8 ~ k_dat2$m8,family=binomial(link='logit'),data=k_dat2)
m8 <-exp(cbind(coef(ml8), confint(ml8))) 

ml9 <- glm(k_dat2$k_m47 ~ k_dat2$m47,family=binomial(link='logit'),data=k_dat2)
m9 <-exp(cbind(coef(ml9), confint(ml9))) 

ml10 <- glm(k_dat2$k_m48 ~ k_dat2$m48,family=binomial(link='logit'),data=k_dat2)
m10 <-exp(cbind(coef(ml10), confint(ml10))) 

ml11 <- glm(k_dat2$k_m54 ~ k_dat2$m54,family=binomial(link='logit'),data=k_dat2)
m11<-exp(cbind(coef(ml11), confint(ml11))) 

ml12 <- glm(k_dat2$k_m9 ~ k_dat2$m9,family=binomial(link='logit'),data=k_dat2)
m12<-exp(cbind(coef(ml12), confint(ml12))) 

ml13 <- glm(k_dat2$k_m10 ~ k_dat2$m10,family=binomial(link='logit'),data=k_dat2)
m13<-exp(cbind(coef(ml13), confint(ml13))) 

ml14 <- glm(k_dat2$k_m11 ~ k_dat2$m11,family=binomial(link='logit'),data=k_dat2)
m14<-exp(cbind(coef(ml14), confint(ml14))) 

ml15 <- glm(k_dat2$k_m12 ~ k_dat2$m12,family=binomial(link='logit'),data=k_dat2)
m15<-exp(cbind(coef(ml15), confint(ml15))) 

ml16 <- glm(k_dat2$k_auttaminentaminen ~ k_dat2$m18,family=binomial(link='logit'),data=k_dat2)
m16<-exp(cbind(coef(ml16), confint(ml16))) 

ml17 <- glm(k_dat2$k_m19 ~ k_dat2$m19,family=binomial(link='logit'),data=k_dat2)
m17<-exp(cbind(coef(ml17), confint(ml17))) 

ml18 <- glm(k_dat2$k_m20 ~ k_dat2$m20,family=binomial(link='logit'),data=k_dat2)
m18<-exp(cbind(coef(ml18), confint(ml18))) 

ml19 <- glm(k_dat2$k_m21 ~ k_dat2$m21,family=binomial(link='logit'),data=k_dat2)
m19<-exp(cbind(coef(ml19), confint(ml19))) 

ml20 <- glm(k_dat2$k_m24 ~ k_dat2$m24,family=binomial(link='logit'),data=k_dat2)
m20<-exp(cbind(coef(ml20), confint(ml20))) 

ml21 <- glm(k_dat2$k_m67 ~ k_dat2$m67,family=binomial(link='logit'),data=k_dat2)
m21<-exp(cbind(coef(ml21), confint(ml21))) 

ml22 <- glm(k_dat2$k_m31 ~ k_dat2$m31,family=binomial(link='logit'),data=k_dat2)
m22<-exp(cbind(coef(ml22), confint(ml22))) 

ml23 <- glm(k_dat2$k_m26 ~ k_dat2$m26,family=binomial(link='logit'),data=k_dat2)
m23<-exp(cbind(coef(ml23), confint(ml23))) 

ml24 <- glm(k_dat2$k_m27 ~ k_dat2$m27,family=binomial(link='logit'),data=k_dat2)
m24<-exp(cbind(coef(ml24), confint(ml24))) 

ml25 <- glm(k_dat2$k_m28 ~ k_dat2$m28,family=binomial(link='logit'),data=k_dat2)
m25<-exp(cbind(coef(ml25), confint(ml25))) 

ml26 <- glm(k_dat2$k_m29 ~ k_dat2$m29,family=binomial(link='logit'),data=k_dat2)
m26<-exp(cbind(coef(ml26), confint(ml26))) 

ml27 <- glm(k_dat2$k_m30 ~ k_dat2$m30,family=binomial(link='logit'),data=k_dat2)
m27<-exp(cbind(coef(ml27), confint(ml27))) 

ml28 <- glm(k_dat2$k_m55 ~ k_dat2$m55,family=binomial(link='logit'),data=k_dat2)
m28<-exp(cbind(coef(ml28), confint(ml28))) 

ml29 <- glm(k_dat2$k_m32 ~ k_dat2$m32,family=binomial(link='logit'),data=k_dat2)
m29<-exp(cbind(coef(ml29), confint(ml29))) 

ml30 <- glm(k_dat2$k_m68 ~ k_dat2$m68,family=binomial(link='logit'),data=k_dat2)
m30<-exp(cbind(coef(ml30), confint(ml30))) 

ml31 <- glm(k_dat2$k_m22 ~ k_dat2$m22,family=binomial(link='logit'),data=k_dat2)
m31<-exp(cbind(coef(ml31), confint(ml31))) 

ml32 <- glm(k_dat2$k_m33 ~ k_dat2$m33,family=binomial(link='logit'),data=k_dat2)
m32<-exp(cbind(coef(ml32), confint(ml32))) 

ml33 <- glm(k_dat2$k_m34 ~ k_dat2$m34,family=binomial(link='logit'),data=k_dat2)
m33<-exp(cbind(coef(ml33), confint(ml33))) 

ml34 <- glm(k_dat2$k_m35 ~ k_dat2$m35,family=binomial(link='logit'),data=k_dat2)
m34<-exp(cbind(coef(ml34), confint(ml34))) 

ml35 <- glm(k_dat2$k_m36 ~ k_dat2$m36,family=binomial(link='logit'),data=k_dat2)
m35<-exp(cbind(coef(ml35), confint(ml35))) 

ml36 <- glm(k_dat2$k_m38 ~ k_dat2$m38,family=binomial(link='logit'),data=k_dat2)
m36<-exp(cbind(coef(ml36), confint(ml36))) 

ml37 <- glm(k_dat2$k_m39 ~ k_dat2$m39,family=binomial(link='logit'),data=k_dat2)
m37<-exp(cbind(coef(ml37), confint(ml37))) 


ml40 <- glm(k_dat2$k_m42 ~ k_dat2$m42,family=binomial(link='logit'),data=k_dat2)
m40<-exp(cbind(coef(ml40), confint(ml40))) 

ml41 <- glm(k_dat2$k_m43 ~ k_dat2$m43,family=binomial(link='logit'),data=k_dat2)
m41<-exp(cbind(coef(ml41), confint(ml41))) 

ml42 <- glm(k_dat2$k_m44 ~ k_dat2$m44,family=binomial(link='logit'),data=k_dat2)
m42<-exp(cbind(coef(ml42), confint(ml42))) 

ml43 <- glm(k_dat2$k_m45 ~ k_dat2$m45,family=binomial(link='logit'),data=k_dat2)
m43<-exp(cbind(coef(ml43), confint(ml43))) 

ml44 <- glm(k_dat2$k_m46 ~ k_dat2$m46,family=binomial(link='logit'),data=k_dat2)
m44<-exp(cbind(coef(ml44), confint(ml44))) 

ml45 <- glm(k_dat2$k_m13 ~ k_dat2$m13,family=binomial(link='logit'),data=k_dat2)
m45<-exp(cbind(coef(ml45), confint(ml45))) 

ml46 <- glm(k_dat2$k_m69 ~ k_dat2$m69,family=binomial(link='logit'),data=k_dat2)
m46<-exp(cbind(coef(ml46), confint(ml46))) 

ml47 <- glm(k_dat2$k_m49 ~ k_dat2$m49,family=binomial(link='logit'),data=k_dat2)
m47<-exp(cbind(coef(ml47), confint(ml47))) 

ml48 <- glm(k_dat2$k_m14 ~ k_dat2$m14,family=binomial(link='logit'),data=k_dat2)
m48<-exp(cbind(coef(ml48), confint(ml48))) 

ml49 <- glm(k_dat2$k_m57 ~ k_dat2$m57,family=binomial(link='logit'),data=k_dat2)
m49<-exp(cbind(coef(ml49), confint(ml49))) 

ml50 <- glm(k_dat2$k_m15 ~ k_dat2$m15,family=binomial(link='logit'),data=k_dat2)
m50<-exp(cbind(coef(ml50), confint(ml50))) 

ml51 <- glm(k_dat2$k_m16 ~ k_dat2$m16,family=binomial(link='logit'),data=k_dat2)
m51<-exp(cbind(coef(ml51), confint(ml51))) 

ml52 <- glm(k_dat2$k_m17 ~ k_dat2$m17,family=binomial(link='logit'),data=k_dat2)
m52<-exp(cbind(coef(ml52), confint(ml52))) 

ml53 <- glm(k_dat2$k_m50 ~ k_dat2$m50,family=binomial(link='logit'),data=k_dat2)
m53<-exp(cbind(coef(ml53), confint(ml53))) 

ml54 <- glm(k_dat2$k_m51 ~ k_dat2$m51,family=binomial(link='logit'),data=k_dat2)
m54<-exp(cbind(coef(ml54), confint(ml54))) 

ml55 <- glm(k_dat2$k_m52 ~ k_dat2$m52,family=binomial(link='logit'),data=k_dat2)
m55<-exp(cbind(coef(ml55), confint(ml55))) 


ml_all <- rbind(m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, m12, m13, m14, m15, m16, m17, m18, m19, m20, m21, m22, m23, m24, m25, m26, m27, m28, m29, m30, m31, m32, m33, m34, m35, m36, m37, m40, m41, m42, m43, m44, m45, m46, m47, m48, m49, m50, m51, m52, m53, m54, m55)
m_all1 <- round(ml_all, 3)
print(m_all1)
```

N?ist? tuloksista pystyy p??ttelem??n miss? muuttujissa on tilastollisesti merkitt?v? suhde, mihin suuntaan suhde toimii ja miten se k?yt?nn?ss? toimii. Kuitenkin on vaikea verrata muuttujia toisiinsa, sill? muuttujat oimivat eri skaaloilla. 

## Kehitt?mistoimenpide ja muuttujan taso -- normalisoituna

Alla tarkasttellaan ty?yhteis?jen todenn?k?isyytt? valita kehitt?mistoimenpide ja kyseess? olevan muuttujan tason suhdetta.

Alle olen tehnyt mallit kaikista muuttujista. Olen tulostanut jokaisesta mallista vain interceptin ja OR:t, sek? 95% luottamusv?lit. 

Alla olevat laskelmat ovat identti? yll? oleviin, ainoa ero on ett? data on normalisoitu. Eli muuttujien mean on 0 ja standard deviaatio on 1. 


```{r, echo=FALSE}

scaled_k_dat2 <- k_dat2 %>% mutate_each_(funs(scale(.) %>% as.vector), 
                             vars=c(39:97))

ml1 <- glm(scaled_k_dat2$k_tyon_hallinta ~ scaled_k_dat2$m3,family=binomial(link='logit'),data=scaled_k_dat2)
m1 <-exp(cbind(coef(ml1), confint(ml1)))  

ml2 <- glm(scaled_k_dat2$k_auttaminen ~ scaled_k_dat2$m18,family=binomial(link='logit'),data=scaled_k_dat2)
m2 <-exp(cbind(coef(ml2), confint(ml2)))  

ml3 <- glm(scaled_k_dat2$k_ilmapiiri ~ scaled_k_dat2$m23,family=binomial(link='logit'),data=scaled_k_dat2)
m3<-exp(cbind(coef(ml3), confint(ml3)))  

ml4 <- glm(scaled_k_dat2$k_wtc ~ scaled_k_dat2$m1,family=binomial(link='logit'),data=scaled_k_dat2)
m4 <-exp(cbind(coef(ml4), confint(ml4)))  

ml5 <- glm(scaled_k_dat2$k_t_pain ~ scaled_k_dat2$m2,family=binomial(link='logit'),data=scaled_k_dat2)
m5 <-exp(cbind(coef(ml5), confint(ml5)))

ml6 <- glm(scaled_k_dat2$k_m4 ~ scaled_k_dat2$m4,family=binomial(link='logit'),data=scaled_k_dat2)
m6 <-exp(cbind(coef(ml6), confint(ml6))) 

ml7 <- glm(scaled_k_dat2$k_m66 ~ scaled_k_dat2$m66,family=binomial(link='logit'),data=scaled_k_dat2)
m7 <-exp(cbind(coef(ml7), confint(ml7))) 

ml8 <- glm(scaled_k_dat2$k_m8 ~ scaled_k_dat2$m8,family=binomial(link='logit'),data=scaled_k_dat2)
m8 <-exp(cbind(coef(ml8), confint(ml8))) 

ml9 <- glm(scaled_k_dat2$k_m47 ~ scaled_k_dat2$m47,family=binomial(link='logit'),data=scaled_k_dat2)
m9 <-exp(cbind(coef(ml9), confint(ml9))) 

ml10 <- glm(scaled_k_dat2$k_m48 ~ scaled_k_dat2$m48,family=binomial(link='logit'),data=scaled_k_dat2)
m10 <-exp(cbind(coef(ml10), confint(ml10))) 

ml11 <- glm(scaled_k_dat2$k_m54 ~ scaled_k_dat2$m54,family=binomial(link='logit'),data=scaled_k_dat2)
m11<-exp(cbind(coef(ml11), confint(ml11))) 

ml12 <- glm(scaled_k_dat2$k_m9 ~ scaled_k_dat2$m9,family=binomial(link='logit'),data=scaled_k_dat2)
m12<-exp(cbind(coef(ml12), confint(ml12))) 

ml13 <- glm(scaled_k_dat2$k_m10 ~ scaled_k_dat2$m10,family=binomial(link='logit'),data=scaled_k_dat2)
m13<-exp(cbind(coef(ml13), confint(ml13))) 

ml14 <- glm(scaled_k_dat2$k_m11 ~ scaled_k_dat2$m11,family=binomial(link='logit'),data=scaled_k_dat2)
m14<-exp(cbind(coef(ml14), confint(ml14))) 

ml15 <- glm(scaled_k_dat2$k_m12 ~ scaled_k_dat2$m12,family=binomial(link='logit'),data=scaled_k_dat2)
m15<-exp(cbind(coef(ml15), confint(ml15))) 

ml16 <- glm(scaled_k_dat2$k_auttaminentaminen ~ scaled_k_dat2$m18,family=binomial(link='logit'),data=scaled_k_dat2)
m16<-exp(cbind(coef(ml16), confint(ml16))) 

ml17 <- glm(scaled_k_dat2$k_m19 ~ scaled_k_dat2$m19,family=binomial(link='logit'),data=scaled_k_dat2)
m17<-exp(cbind(coef(ml17), confint(ml17))) 

ml18 <- glm(scaled_k_dat2$k_m20 ~ scaled_k_dat2$m20,family=binomial(link='logit'),data=scaled_k_dat2)
m18<-exp(cbind(coef(ml18), confint(ml18))) 

ml19 <- glm(scaled_k_dat2$k_m21 ~ scaled_k_dat2$m21,family=binomial(link='logit'),data=scaled_k_dat2)
m19<-exp(cbind(coef(ml19), confint(ml19))) 

ml20 <- glm(scaled_k_dat2$k_m24 ~ scaled_k_dat2$m24,family=binomial(link='logit'),data=scaled_k_dat2)
m20<-exp(cbind(coef(ml20), confint(ml20))) 

ml21 <- glm(scaled_k_dat2$k_m67 ~ scaled_k_dat2$m67,family=binomial(link='logit'),data=scaled_k_dat2)
m21<-exp(cbind(coef(ml21), confint(ml21))) 

ml22 <- glm(scaled_k_dat2$k_m31 ~ scaled_k_dat2$m31,family=binomial(link='logit'),data=scaled_k_dat2)
m22<-exp(cbind(coef(ml22), confint(ml22))) 

ml23 <- glm(scaled_k_dat2$k_m26 ~ scaled_k_dat2$m26,family=binomial(link='logit'),data=scaled_k_dat2)
m23<-exp(cbind(coef(ml23), confint(ml23))) 

ml24 <- glm(scaled_k_dat2$k_m27 ~ scaled_k_dat2$m27,family=binomial(link='logit'),data=scaled_k_dat2)
m24<-exp(cbind(coef(ml24), confint(ml24))) 

ml25 <- glm(scaled_k_dat2$k_m28 ~ scaled_k_dat2$m28,family=binomial(link='logit'),data=scaled_k_dat2)
m25<-exp(cbind(coef(ml25), confint(ml25))) 

ml26 <- glm(scaled_k_dat2$k_m29 ~ scaled_k_dat2$m29,family=binomial(link='logit'),data=scaled_k_dat2)
m26<-exp(cbind(coef(ml26), confint(ml26))) 

ml27 <- glm(scaled_k_dat2$k_m30 ~ scaled_k_dat2$m30,family=binomial(link='logit'),data=scaled_k_dat2)
m27<-exp(cbind(coef(ml27), confint(ml27))) 

ml28 <- glm(scaled_k_dat2$k_m55 ~ scaled_k_dat2$m55,family=binomial(link='logit'),data=scaled_k_dat2)
m28<-exp(cbind(coef(ml28), confint(ml28))) 

ml29 <- glm(scaled_k_dat2$k_m32 ~ scaled_k_dat2$m32,family=binomial(link='logit'),data=scaled_k_dat2)
m29<-exp(cbind(coef(ml29), confint(ml29))) 

ml30 <- glm(scaled_k_dat2$k_m68 ~ scaled_k_dat2$m68,family=binomial(link='logit'),data=scaled_k_dat2)
m30<-exp(cbind(coef(ml30), confint(ml30))) 

ml31 <- glm(scaled_k_dat2$k_m22 ~ scaled_k_dat2$m22,family=binomial(link='logit'),data=scaled_k_dat2)
m31<-exp(cbind(coef(ml31), confint(ml31))) 

ml32 <- glm(scaled_k_dat2$k_m33 ~ scaled_k_dat2$m33,family=binomial(link='logit'),data=scaled_k_dat2)
m32<-exp(cbind(coef(ml32), confint(ml32))) 

ml33 <- glm(scaled_k_dat2$k_m34 ~ scaled_k_dat2$m34,family=binomial(link='logit'),data=scaled_k_dat2)
m33<-exp(cbind(coef(ml33), confint(ml33))) 

ml34 <- glm(scaled_k_dat2$k_m35 ~ scaled_k_dat2$m35,family=binomial(link='logit'),data=scaled_k_dat2)
m34<-exp(cbind(coef(ml34), confint(ml34))) 

ml35 <- glm(scaled_k_dat2$k_m36 ~ scaled_k_dat2$m36,family=binomial(link='logit'),data=scaled_k_dat2)
m35<-exp(cbind(coef(ml35), confint(ml35))) 

ml36 <- glm(scaled_k_dat2$k_m38 ~ scaled_k_dat2$m38,family=binomial(link='logit'),data=scaled_k_dat2)
m36<-exp(cbind(coef(ml36), confint(ml36))) 

ml37 <- glm(scaled_k_dat2$k_m39 ~ scaled_k_dat2$m39,family=binomial(link='logit'),data=scaled_k_dat2)
m37<-exp(cbind(coef(ml37), confint(ml37))) 


ml40 <- glm(scaled_k_dat2$k_m42 ~ scaled_k_dat2$m42,family=binomial(link='logit'),data=scaled_k_dat2)
m40<-exp(cbind(coef(ml40), confint(ml40))) 

ml41 <- glm(scaled_k_dat2$k_m43 ~ scaled_k_dat2$m43,family=binomial(link='logit'),data=scaled_k_dat2)
m41<-exp(cbind(coef(ml41), confint(ml41))) 

ml42 <- glm(scaled_k_dat2$k_m44 ~ scaled_k_dat2$m44,family=binomial(link='logit'),data=scaled_k_dat2)
m42<-exp(cbind(coef(ml42), confint(ml42))) 

ml43 <- glm(scaled_k_dat2$k_m45 ~ scaled_k_dat2$m45,family=binomial(link='logit'),data=scaled_k_dat2)
m43<-exp(cbind(coef(ml43), confint(ml43))) 

ml44 <- glm(scaled_k_dat2$k_m46 ~ scaled_k_dat2$m46,family=binomial(link='logit'),data=scaled_k_dat2)
m44<-exp(cbind(coef(ml44), confint(ml44))) 

ml45 <- glm(scaled_k_dat2$k_m13 ~ scaled_k_dat2$m13,family=binomial(link='logit'),data=scaled_k_dat2)
m45<-exp(cbind(coef(ml45), confint(ml45))) 

ml46 <- glm(scaled_k_dat2$k_m69 ~ scaled_k_dat2$m69,family=binomial(link='logit'),data=scaled_k_dat2)
m46<-exp(cbind(coef(ml46), confint(ml46))) 

ml47 <- glm(scaled_k_dat2$k_m49 ~ scaled_k_dat2$m49,family=binomial(link='logit'),data=scaled_k_dat2)
m47<-exp(cbind(coef(ml47), confint(ml47))) 

ml48 <- glm(scaled_k_dat2$k_m14 ~ scaled_k_dat2$m14,family=binomial(link='logit'),data=scaled_k_dat2)
m48<-exp(cbind(coef(ml48), confint(ml48))) 

ml49 <- glm(scaled_k_dat2$k_m57 ~ scaled_k_dat2$m57,family=binomial(link='logit'),data=scaled_k_dat2)
m49<-exp(cbind(coef(ml49), confint(ml49))) 

ml50 <- glm(scaled_k_dat2$k_m15 ~ scaled_k_dat2$m15,family=binomial(link='logit'),data=scaled_k_dat2)
m50<-exp(cbind(coef(ml50), confint(ml50))) 

ml51 <- glm(scaled_k_dat2$k_m16 ~ scaled_k_dat2$m16,family=binomial(link='logit'),data=scaled_k_dat2)
m51<-exp(cbind(coef(ml51), confint(ml51))) 

ml52 <- glm(scaled_k_dat2$k_m17 ~ scaled_k_dat2$m17,family=binomial(link='logit'),data=scaled_k_dat2)
m52<-exp(cbind(coef(ml52), confint(ml52))) 

ml53 <- glm(scaled_k_dat2$k_m50 ~ scaled_k_dat2$m50,family=binomial(link='logit'),data=scaled_k_dat2)
m53<-exp(cbind(coef(ml53), confint(ml53))) 

ml54 <- glm(scaled_k_dat2$k_m51 ~ scaled_k_dat2$m51,family=binomial(link='logit'),data=scaled_k_dat2)
m54<-exp(cbind(coef(ml54), confint(ml54))) 

ml55 <- glm(scaled_k_dat2$k_m52 ~ scaled_k_dat2$m52,family=binomial(link='logit'),data=scaled_k_dat2)
m55<-exp(cbind(coef(ml55), confint(ml55))) 


ml_all <- rbind(m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, m12, m13, m14, m15, m16, m17, m18, m19, m20, m21, m22, m23, m24, m25, m26, m27, m28, m29, m30, m31, m32, m33, m34, m35, m36, m37, m40, m41, m42, m43, m44, m45, m46, m47, m48, m49, m50, m51, m52, m53, m54, m55)
m_all1 <- round(ml_all, 3)
print(m_all1)
```


## Lasso

Lasso-regressiota ei voi tehd? puuttuvien arvojen kanssa. T?m? on sin??ns? ongelma, koska joillakin ty?paikoilla on puuttuvia arvoja. My?sk??n n?m? puuttuvat arvot eiv?t esiinny satunnaisesti vaan ovat yleens? tietyntyyppisten (kokoisten ty?paikkojen ongelma). T?m? analyysi on viel? vahvasti kesken,ja tulokset ovat vain alustavasti suuntaa antavia

### Ty?yhteis?taidot: auttaminen ja huomaavaisuus
Alla oleva Lasso on tehty datalla josta puuttuvat arvot ovat poistettu. Lopussa oleva malli on Lasson optimoima regressiomalli jos mallennetaan Ty?yhteis?taidot: auttaminen ja huomaavaisuus valitsemista kehitt?miskohteeksi
